cd C:\work\bbitai\felho_lab

cd ..
docker compose -f pdocker-compose.yml build

cd felho_lab
kubectl delete deployment photo-ui
kubectl apply -f manifests.yaml
kubectl get pod

helm repo add traefik https://traefik.github.io/charts
helm repo update

helm uninstall traefik
helm list --all-namespaces

helm install traefik traefik/traefik --set ports.web.nodePort=32080 --set service.type=NodePort --set "additionalArguments={--api.insecure=true}"
helm upgrade traefik traefik/traefik --set ports.web.nodePort=32080 --set service.type=NodePort --set "additionalArguments={--api.insecure=true}"

helm install traefik traefik/traefik -f traefik-values.yaml
helm upgrade traefik traefik/traefik -f traefik-values.yaml

kubectl delete deployment photo-service
kubectl delete deployment photo-ui
kubectl delete deployment sqlserver
kubectl get deployment

kubectl logs photo-service-service-
kubectl describe pod photo-service-

kubectl port-forward pod/sqlserver-5f5585b58-bjj8j 1434:1433
127.0.0.1,1434
username: ps
pass: ps

kubectl port-forward pod/keycloak-d786fd4f-77mbk 18080:8080

http://localhost:8090/api/photo/photos?sortBy=date&order=desc
http://localhost:8090/api/photo/photos/1

realm:skal
http://localhost:18080/realms/skal/protocol/openid-connect/auth
http://localhost:18080/realms/skal/protocol/openid-connect/token
client id: ps
user:ps PS_USER realm roleal
client secret: fn41Zt7X3zWGas71RNazJ79Eibli7hDd


This is the backend for a photo album app.

The features of the app essentially is user management, and CRUD functionality for photos. Here is the detailed functionality:
-Uploading, deleting photos.
-List the names and dates of photos, sorted either by name or by date.
-Clicking on a list item should display the corresponding image.
-User management (registration, login, logout).
-Uploading and deleting are only permitted for logged-in users

The api of the app is defined in ps_api.yaml. using openapi-genrator-maven-plugin the api is generated, and then implemented in PhotoServiceController.
PhotoServiceController then calls PhotoServiceImpl.



i have added the ui project to tthe ui folder so you can see them, it will be removed later.
This app runs in kubernetes, using manifests.yaml. I use pdocker-compose.yml to build the images. I need you to generate a Dockerfile for the ui project, add the ui project to the pdocker-compose.yml file, and the manifest.yml file. In the kuberentes i use traefik for routing. trafeik is not present in the manifest, its added with the helm install traefik traefik/traefik -f traefik-values.yaml command. traefik-values.yaml contains the config for it. in the manifest.yaml the photo-service-ingress and photo-stripprefix is used by traefik for the routing configuartion. We probably need a similiar ingress and stripprefix for the ui project.




for maven build, use this command: C:\Program Files\JetBrains\IntelliJ IDEA 2025.2.4\plugins\maven\lib\maven3\bin\mvn.cmd -Didea.version=2025.2.5 -Dmaven.ext.class.path=C:\Program Files\JetBrains\IntelliJ IDEA 2025.2.4\plugins\maven\lib\maven-event-listener.jar -Djansi.passthrough=true -Dstyle.color=always -Dmaven.repo.local=C:\Users\bbitai\.m2\repository clean install -U -e -f pom.xml







# Copy built application from builder
COPY --from=builder /app/dist/photo-ui/browser /usr/share/nginx/html/ui

we have a photo ablum app running in kuubernetes. i build the images like this: docker compose -f pdocker-compose.yml build
apply changes : kubectl apply -f manifests.yam
you can find these files in this project. i use traefik for routing, traefik is not in the compose and the manifest file, instead its added with this command: helm upgrade traefik traefik/traefik -f traefik-values.yam
l traefik-values.yaml can also be found in the project files.for the photo-ui i use nginx.conf file in the ui/nginx.conf directory.

the pods are running correctly(mongodb doesnt matter, its not used):
C:\work\bbitai\felho_lab>kubectl get pod NAME                            READY   STATUS             RESTARTS          AGE keycloak-d786fd4f-77mbk         1/1     Running            78 (68m ago)      2d17h mongodb-0                       0/1     CrashLoopBackOff   125 (3m43s ago)   42h photo-service-d8c5c86f4-9c8ff   1/1     Running            3 (68m ago)       41h photo-ui-dbcbfc684-cnw2g        1/1     Running            0                 5m25s postgresql-678fd5c745-cwbr7     1/1     Running            3 (68m ago)       2d17h rabbitmq-0                      1/1     Running            5 (68m ago)       32d sqlserver-5f5585b58-bjj8j       1/1     Running            3 (68m ago)       42h traefik-55fd57cd45-slkc6        1/1     Running            3 (68m ago)41h

when is try to go to the photo-ui in the browser:http://localhost:8090/ui
i get to the nginx default page: "Welcome to nginx! If you see this page, the nginx web server is successfully installed and working. Further configuration is required.  For online documentation and support please refer to nginx.org. Commercial support is available at nginx.com.  Thank you for using nginx."
i think the photo-ui is running correctly based on the container logs:
/docker-entrypoint.sh: /docker-entrypoint.d/ is not empty, will attempt to perform configuration  /docker-entrypoint.sh: Looking for shell scripts in /docker-entrypoint.d/  /docker-entrypoint.sh: Launching /docker-entrypoint.d/10-listen-on-ipv6-by-default.sh  10-listen-on-ipv6-by-default.sh: info: Getting the checksum of /etc/nginx/conf.d/default.conf  10-listen-on-ipv6-by-default.sh: info: /etc/nginx/conf.d/default.conf differs from the packaged version  /docker-entrypoint.sh: Sourcing /docker-entrypoint.d/15-local-resolvers.envsh  /docker-entrypoint.sh: Launching /docker-entrypoint.d/20-envsubst-on-templates.sh  /docker-entrypoint.sh: Launching /docker-entrypoint.d/30-tune-worker-processes.sh  /docker-entrypoint.sh: Configuration complete; ready for start up  2026/02/19 09:46:38 [notice] 1#1: using the "epoll" event method  2026/02/19 09:46:38 [notice] 1#1: nginx/1.29.5  2026/02/19 09:46:38 [notice] 1#1: built by gcc 15.2.0 (Alpine 15.2.0)   2026/02/19 09:46:38 [notice] 1#1: OS: Linux 6.6.87.2-microsoft-standard-WSL2  2026/02/19 09:46:38 [notice] 1#1: getrlimit(RLIMIT_NOFILE): 1048576:1048576  2026/02/19 09:46:38 [notice] 1#1: start worker processes  2026/02/19 09:46:38 [notice] 1#1: start worker process 29  2026/02/19 09:46:38 [notice] 1#1: start worker process 30  2026/02/19 09:46:38 [notice] 1#1: start worker process 31  2026/02/19 09:46:38 [notice] 1#1: start worker process 32  2026/02/19 09:46:38 [notice] 1#1: start worker process 33  2026/02/19 09:46:38 [notice] 1#1: start worker process 34  2026/02/19 09:46:38 [notice] 1#1: start worker process 35  2026/02/19 09:46:38 [notice] 1#1: start worker process 36  2026/02/19 09:46:38 [notice] 1#1: start worker process 37  2026/02/19 09:46:38 [notice] 1#1: start worker process 38  2026/02/19 09:46:38 [notice] 1#1: start worker process 39  2026/02/19 09:46:38 [notice] 1#1: start worker process 40  2026/02/19 09:46:38 [notice] 1#1: start worker process 41  2026/02/19 09:46:38 [notice] 1#1: start worker process 42  2026/02/19 09:46:38 [notice] 1#1: start worker process 43  2026/02/19 09:46:38 [notice] 1#1: start worker process 44  2026/02/19 09:46:38 [notice] 1#1: start worker process 45  2026/02/19 09:46:38 [notice] 1#1: start worker process 46  2026/02/19 09:46:38 [notice] 1#1: start worker process 47  2026/02/19 09:46:38 [notice] 1#1: start worker process 48  2026/02/19 09:46:38 [notice] 1#1: start worker process 49  2026/02/19 09:46:38 [notice] 1#1: start worker process 50  10.1.0.1 - - [19/Feb/2026:09:46:49 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:46:57 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:46:59 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:47:09 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.2.91 - - [19/Feb/2026:09:47:12 +0000] "GET / HTTP/1.1" 200 409 "-" "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/144.0.0.0 Safari/537.36" "192.168.65.3"  10.1.0.1 - - [19/Feb/2026:09:47:17 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:47:19 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:47:29 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:47:37 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"  10.1.0.1 - - [19/Feb/2026:09:47:39 +0000] "GET /index.html HTTP/1.1" 200 615 "-" "kube-probe/1.34" "-"